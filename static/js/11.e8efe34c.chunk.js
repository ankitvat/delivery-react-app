(this["webpackJsonpdelivery-crm"]=this["webpackJsonpdelivery-crm"]||[]).push([[11],{114:function(e,t,a){"use strict";t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"export.csv",a=document.createElement("a"),r=[];e.forEach((function(e){e=e.join(","),r.push(e)}));var c=r.join("\n");null!=c&&(c.match(/^data:text\/csv/i)||(c="data:text/csv;charset=utf-8,".concat(c)),a.setAttribute("href",encodeURI(c)),a.setAttribute("download",t),a.click())}},135:function(e,t,a){"use strict";var r=a(91),c=a(92);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=c(a(0)),n=(0,r(a(93)).default)(o.createElement("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward");t.default=n},243:function(e,t,a){"use strict";a.r(t);var r=a(42),c=a(89),o=a(90),n=a(96),s=a(95),i=a(10),l=a(4),d=a(0),u=a(38),h=a(134),b=a.n(h),j=a(136),m=a.n(j),f=a(233),p=a(135),v=a.n(p),O=a(114),x=a(68),w=a(258),y=a(155),C=a(190),g=a(111),S=a(117),D=a(40);var L=function(e){Object(n.a)(a,e);var t=Object(s.a)(a);function a(e){var o;return Object(c.a)(this,a),(o=t.call(this,e)).updateState=function(e){o.setState({selectedRows:e.selectedRows})},o.createCrateNumbers=function(){if(new Date(localStorage.getItem("cratesLastCreated",(new Date).toISOString()))>(new Date).setHours(0))alert("Crates IDs Already created");else{localStorage.setItem("cratesLastCreated",(new Date).toISOString()),o.setState({creatingCrate:!0});var e=o.props.customers,t=[];e.forEach((function(e){var a=e.order_id,r=e.crateId;t.push({order_id:a,crate_id:r})})),Object(S.e)({orderCrateIds:t}).then((function(e){window.location.reload()}))}},o.columns=[{name:"Crate",selector:"crate_id",sortable:!0,width:"90px"},{name:"Order Id",selector:"order_id",sortable:!0,width:"90px"},{name:"Hub",sortable:!0,width:"100px",cell:function(e,t){return e.address.hub}},{name:"Name",selector:"name",sortable:!0,width:"200px"},{name:"Phone",selector:"phone",sortable:!0,width:"140px"},{name:"Product",selector:"products",sortable:!1,cell:function(e,t){var a=e.phone,r=e.allProducts;return Object(l.jsxs)("table",{style:{width:"100%",textAlign:"left"},id:"customer-sheet-table",children:[Object(l.jsx)("thead",{children:Object(l.jsxs)("tr",{children:[Object(l.jsx)("th",{children:"Name"}),Object(l.jsx)("th",{children:"Total"}),Object(l.jsx)("th",{children:"Qty"})]})}),Object(l.jsx)("tbody",{children:r.map((function(e){var t=e.total,r=e.unit,c=e.quantity,o=e.product;return Object(l.jsxs)("tr",{children:[Object(l.jsx)("td",{children:o}),Object(l.jsxs)("td",{className:"fixed-width-column",children:[t," ",r]}),Object(l.jsx)("td",{className:"fixed-width-column",children:c})]},a.toString()+Math.random().toString())}))})]})}}],o.exportData=function(){var e=o.props.customers,t=Array.from(e.values()),a=o.state.removeSelectedDairy;t.sort((function(e,t){return e.crate_id-t.crate_id}));var c=[["Crate","Hub","Name","Phone","Address","Product","Category","Total","Qty"]];t.forEach((function(e){var t=e.products,o=e.phone,n=e.address,s=n.house_number,i=n.subarea,l=n.area,d=n.hub,u='"'.concat(s,", ").concat(i,", ").concat(l,'"'),h=Object.entries(t),b=[];h.forEach((function(e){var t=Object(r.a)(e,2),c=t[0],o=t[1];"Dairy"!==c&&o.forEach((function(e){e.category=c,a&&(e.product.toLowerCase().includes("milk")||e.product.toLowerCase().includes("paneer"))||b.push(e)}))})),b.forEach((function(t,a){var r=t.total,n=t.unit,s=t.quantity,i=t.category;if(0===a){var l=[e.crate_id,"".concat(d),"".concat(e.name),"".concat(o),u,'"'.concat(t.product,'"'),"".concat(i),"".concat(r," ").concat(n),"".concat(s)];c.push(l)}else{var h=["","","","","",'"'.concat(t.product,'"'),"".concat(i),"".concat(r," ").concat(n),"".concat(s)];c.push(h)}}))})),Object(O.a)(c,"Customer Sheet - ".concat((new Date).toLocaleDateString(),".csv"))},o.state={loading:!0,removeSelectedDairy:!0},o}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=!0,a=this.props.customers,c=this.state,o=c.creatingCrate,n=c.removeSelectedDairy,s=c.search,i=[];return a&&(t=!1,(i=Array.from(a.values())).forEach((function(e){var t=e.products,a=(e.phone,e.address),c=a.house_number,o=a.subarea,s=a.area,i=(a.hub,'"'.concat(c,", ").concat(o,", ").concat(s,'"'),Object.entries(t)),l=[];i.forEach((function(e){var t=Object(r.a)(e,2),a=t[0],c=t[1];"Dairy"!==a&&c.forEach((function(e){e.category=a,n&&(e.product.toLowerCase().includes("milk")||e.product.toLowerCase().includes("paneer"))||l.push(e)}))})),e.allProducts=l})),i=i.filter((function(e){var t=e.name,a=e.phone;return 0!==e.allProducts.length&&(!s||(!!t.toLowerCase().includes(s.toLowerCase())||!!a.toLowerCase().includes(s.toLowerCase())))})),console.log(i)),Object(l.jsx)("div",{children:t?Object(l.jsx)(D.a,{}):Object(l.jsx)("div",{id:"customer-sheet-table",children:Object(l.jsx)(b.a,{data:i,columns:this.columns,sortIcon:Object(l.jsx)(v.a,{}),actions:Object(l.jsxs)("div",{className:"flex middle",children:[Object(l.jsx)(w.a,{label:"Search Customer",style:{marginRight:10},onChange:function(t){e.setState({search:t.target.value})}}),Object(l.jsx)(y.a,{control:Object(l.jsx)(C.a,{checked:n,onChange:function(t,a){return e.setState({removeSelectedDairy:a})},color:"primary"}),label:"Remove Milk and Paneer"}),Object(l.jsx)(f.a,{variant:"outlined",color:"primary",startIcon:o?Object(l.jsx)(x.a,{size:12}):null,disabled:o,style:{marginRight:4},onClick:this.createCrateNumbers,children:"Create Crate Numbers"}),Object(l.jsx)(f.a,{startIcon:Object(l.jsx)(m.a,{}),color:"secondary",variant:"outlined",onClick:this.exportData,children:"Download Excel"})]})})})})}}]),a}(d.Component);t.default=Object(u.b)((function(e){var t=e.setAdmin;return Object(i.a)({},t)}),(function(e){return{onUpdateOrdersData:function(t){return e(Object(g.c)(t))}}}))(L)}}]);
//# sourceMappingURL=11.e8efe34c.chunk.js.map