(this["webpackJsonpdelivery-crm"]=this["webpackJsonpdelivery-crm"]||[]).push([[16],{125:function(e,t,r){"use strict";t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"export.csv",r=document.createElement("a"),a=[];e.forEach((function(e){e=e.join(","),a.push(e)}));var c=a.join("\n");null!=c&&(c.match(/^data:text\/csv/i)||(c="data:text/csv;charset=utf-8,".concat(c)),r.setAttribute("href",encodeURI(c)),r.setAttribute("download",t),r.click())}},146:function(e,t,r){"use strict";var a=r(91),c=r(92);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=c(r(0)),n=(0,a(r(93)).default)(o.createElement("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward");t.default=n},282:function(e,t,r){"use strict";r.r(t);var a=r(44),c=r(94),o=r(95),n=r(98),s=r(97),i=r(10),l=r(3),d=r(0),u=r(39),h=r(145),b=r.n(h),j=r(129),m=r.n(j),f=r(270),v=r(146),p=r.n(v),O=r(125),x=r(70),w=r(300),C=r(147),y=r(170),g=r(121),S=r(119),D=r(42);var L=function(e){Object(n.a)(r,e);var t=Object(s.a)(r);function r(e){var o;return Object(c.a)(this,r),(o=t.call(this,e)).updateState=function(e){o.setState({selectedRows:e.selectedRows})},o.createCrateNumbers=function(){if(new Date(localStorage.getItem("cratesLastCreated",(new Date).toISOString()))>(new Date).setHours(0))alert("Crates IDs Already created");else{localStorage.setItem("cratesLastCreated",(new Date).toISOString()),o.setState({creatingCrate:!0});var e=o.props.customers,t=[];e.forEach((function(e){var r=e.order_id,a=e.crateId;t.push({order_id:r,crate_id:a})})),Object(S.f)({orderCrateIds:t}).then((function(e){window.location.reload()}))}},o.columns=[{name:"Crate",selector:"crate_id",sortable:!0,width:"90px"},{name:"Order Id",selector:"order_id",sortable:!0,width:"90px"},{name:"Hub",sortable:!0,width:"100px",cell:function(e,t){return e.address.hub}},{name:"Name",selector:"name",sortable:!0,width:"200px"},{name:"Phone",selector:"phone",sortable:!0,width:"140px"},{name:"Product",selector:"products",sortable:!1,cell:function(e,t){var r=e.phone,a=e.allProducts;return Object(l.jsxs)("table",{style:{width:"100%",textAlign:"left"},id:"customer-sheet-table",children:[Object(l.jsx)("thead",{children:Object(l.jsxs)("tr",{children:[Object(l.jsx)("th",{children:"Name"}),Object(l.jsx)("th",{children:"Total"}),Object(l.jsx)("th",{children:"Qty"})]})}),Object(l.jsx)("tbody",{children:a.map((function(e){var t=e.total,a=e.unit,c=e.quantity,o=e.product;return Object(l.jsxs)("tr",{children:[Object(l.jsx)("td",{children:o}),Object(l.jsxs)("td",{className:"fixed-width-column",children:[t," ",a]}),Object(l.jsx)("td",{className:"fixed-width-column",children:c})]},r.toString()+Math.random().toString())}))})]})}}],o.exportData=function(){var e=o.props.customers,t=Array.from(e.values()),r=o.state.removeSelectedDairy;t.sort((function(e,t){return e.crate_id-t.crate_id}));var c=[["Crate","Hub","Name","Phone","Address","Product","Category","Total","Qty"]];t.forEach((function(e){var t=e.products,o=e.phone,n=e.address,s=n.house_number,i=n.subarea,l=n.area,d=n.hub,u='"'.concat(s,", ").concat(i,", ").concat(l,'"'),h=Object.entries(t),b=[];h.forEach((function(e){var t=Object(a.a)(e,2),c=t[0];t[1].forEach((function(e){e.category=c,r&&(e.product.toLowerCase().includes("milk")||e.product.toLowerCase().includes("paneer"))||b.push(e)}))})),b.forEach((function(t,r){var a=t.total,n=t.unit,s=t.quantity,i=t.category;if(0===r){var l=[e.crate_id,"".concat(d),"".concat(e.name),"".concat(o),u,'"'.concat(t.product,'"'),"".concat(i),"".concat(a," ").concat(n),"".concat(s)];c.push(l)}else{var h=["","","","","",'"'.concat(t.product,'"'),"".concat(i),"".concat(a," ").concat(n),"".concat(s)];c.push(h)}}))})),Object(O.a)(c,"Customer Sheet - ".concat((new Date).toLocaleDateString(),".csv"))},o.state={loading:!0,removeSelectedDairy:!0},o}return Object(o.a)(r,[{key:"render",value:function(){var e=this,t=!0,r=this.props.customers,c=this.state,o=c.creatingCrate,n=c.removeSelectedDairy,s=c.search;console.log("removeSelectedDairy",n);var i=[];return r&&(t=!1,(i=Array.from(r.values())).forEach((function(e){var t=e.products,r=Object.entries(t),c=[];r.forEach((function(e){var t=Object(a.a)(e,2),r=t[0];t[1].forEach((function(e){e.category=r,n&&(e.product.toLowerCase().includes("milk")||e.product.toLowerCase().includes("paneer"))||c.push(e)}))})),e.allProducts=c})),i=i.filter((function(e){var t=e.name,r=e.phone;return 0!==e.allProducts.length&&(!s||(!!t.toLowerCase().includes(s.toLowerCase())||!!r.toLowerCase().includes(s.toLowerCase())))}))),Object(l.jsx)("div",{children:t?Object(l.jsx)(D.a,{}):Object(l.jsx)("div",{id:"customer-sheet-table",children:Object(l.jsx)(b.a,{data:i,columns:this.columns,sortIcon:Object(l.jsx)(p.a,{}),actions:Object(l.jsxs)("div",{className:"flex middle",children:[Object(l.jsx)(w.a,{label:"Search Customer",style:{marginRight:10},onChange:function(t){e.setState({search:t.target.value})}}),Object(l.jsx)(C.a,{control:Object(l.jsx)(y.a,{checked:n,onChange:function(t,r){return e.setState({removeSelectedDairy:r})},color:"primary"}),label:"Remove Milk and Paneer"}),Object(l.jsx)(f.a,{variant:"outlined",color:"primary",startIcon:o?Object(l.jsx)(x.a,{size:12}):null,disabled:o,style:{marginRight:4},onClick:this.createCrateNumbers,children:"Create Crate Numbers"}),Object(l.jsx)(f.a,{startIcon:Object(l.jsx)(m.a,{}),color:"secondary",variant:"outlined",onClick:this.exportData,children:"Download Excel"})]})})})})}}]),r}(d.Component);t.default=Object(u.b)((function(e){var t=e.setAdmin;return Object(i.a)({},t)}),(function(e){return{onUpdateOrdersData:function(t){return e(Object(g.c)(t))}}}))(L)}}]);
//# sourceMappingURL=16.45dfe707.chunk.js.map